{"kind":"article","identifier":{"url":"doc:\/\/AriNote\/documentation\/AriNote\/231201_AVPlayer,_waitingToPlayAtSpecifiedRate,_waitingToPlayAtSpecifiedRate","interfaceLanguage":"swift"},"schemaVersion":{"minor":3,"patch":0,"major":0},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/arinote\/231201_avplayer,_waitingtoplayatspecifiedrate,_waitingtoplayatspecifiedrate"]}],"abstract":[{"type":"text","text":"12월 1일 (금)"}],"sections":[],"metadata":{"role":"article","modules":[{"name":"Ari's Notes"}],"title":"231201 AVPlayer, waitingToPlayAtSpecifiedRate, evaluatingBufferingRate","roleHeading":"Article"},"primaryContentSections":[{"kind":"content","content":[{"anchor":"%ED%95%99%EC%8A%B5-%EB%82%B4%EC%9A%A9","level":2,"type":"heading","text":"학습 내용"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"AVPlayer를 담은 셀을 재사용할 때, AVPlayerItem을 할당하여 재생하고 있는데, play()는 제대로 호출하고 있으나 waitingToPlayAtSpecifiedRate에서 playing으로 넘어가지 않고 무한 로딩이 걸리는 문제 해결","type":"text"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":" "}]},{"anchor":"%EA%B3%A0%EB%AF%BC%ED%95%9C-%EC%A0%90--%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95","text":"고민한 점 \/ 해결 방법","level":2,"type":"heading"},{"style":"note","name":"Note","type":"aside","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"비디오 스트리밍을 재생하는 셀이 컬렉션뷰 리로드를 할 때, 재생하던걸 멈추고 셀을 모두 리셋한 다음 다시 데이터가 설정되면서 비디오 스트리밍을 재생해야하는데, 몇개의 셀들이 간헐적으로 재생되지 않는 문제가 발생하여 이를 해결해보았다."}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"처음엔 비디오를 자동 재생을 하는 로직이나 재생하는 시점 로직에 문제가 생겨 사이드 이펙트가 일어나는 줄 알았다."},{"type":"text","text":" "},{"text":"하지만 디버깅 해보니 로직에는 문제가 없었고 정상적으로 ","type":"text"},{"type":"codeVoice","code":"AVPlayer의"},{"type":"text","text":" "},{"code":"play()","type":"codeVoice"},{"type":"text","text":" 메소드는 제대로 호출되고 있었다."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"그래서 AVPlayer의 "},{"code":"timeControlStatus","type":"codeVoice"},{"type":"text","text":", "},{"type":"codeVoice","code":"reasonForWaitingToPlay를"},{"text":" 관찰해보았다.","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"timeControlStatus가","type":"codeVoice"},{"text":" ","type":"text"},{"type":"codeVoice","code":"waitingToPlayAtSpecifiedRate"},{"text":"에서 ","type":"text"},{"type":"codeVoice","code":"playing"},{"text":"으로 바뀌어야하는데, 간헐적으로 바뀌지 않고 계속 ","type":"text"},{"type":"codeVoice","code":"waitingToPlayAtSpecifiedRate"},{"type":"text","text":" 상태인 채로 멈춰서 재생을 하지 않는 것 같았다."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"이때 ","type":"text"},{"type":"codeVoice","code":"reasonForWaitingToPlay를"},{"text":" 추가로 관찰해보니 ","type":"text"},{"code":"evaluatingBufferingRate에서","type":"codeVoice"},{"type":"text","text":" 멈춰서 더이상 상태가 바뀌지 않았다."}]}]}]},{"type":"paragraph","inlineContent":[{"text":"그래서 구글링을 해보았는데… AVPlayer의 자체적인 버그인 것 같았다. 비슷한 현상을 겪는 stackoverflow 글들이 몇개가 존재했다.","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"ios avplayer indefinite waitingToPlayAtSpecifiedRate"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"그래서 "},{"type":"codeVoice","code":"play()"},{"type":"text","text":" 메소드를 호출하기 전에 아래와 같이 로직을 수정하였다."}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"AVPlayerItem"},{"text":"을 다시 초기화한다.","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"replaceCurrentItem(with:)"},{"type":"text","text":" 메소드를 재호출시켜준다."}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"text":"일단 문제되었던 무한로딩 현상은 사라졌지만, 간헐적인 현상이였던지라 이게 정확한 원인인지는 잘 파악이 되진 않는다.","type":"text"},{"type":"text","text":"\n"},{"text":"하지만 일단 오늘 테스트해보았을 때, 더이상 비디오가 재생되지 않는 현상은 사라져서 이걸로 마무리하기로 했다!","type":"text"}]},{"type":"thematicBreak"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"참고링크","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"https:\/\/stackoverflow.com\/questions\/36858988\/avplayer-does-not-fire-playbackbufferempty-but-does-not-play-either","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"https:\/\/developer.apple.com\/documentation\/avfoundation\/avplayer\/timecontrolstatus\/waitingtoplayatspecifiedrate"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"https:\/\/developer.apple.com\/documentation\/avfoundation\/avplayer\/waitingreason\/1643489-evaluatingbufferingrate"}],"type":"paragraph"}]}]}]}]}]}],"hierarchy":{"paths":[["doc:\/\/AriNote\/documentation\/AriNote","doc:\/\/AriNote\/documentation\/AriNote\/UIKit"]]},"references":{"doc://AriNote/documentation/AriNote/UIKit":{"kind":"article","title":"UIKit","abstract":[{"type":"text","text":"한몸이 되보자…"}],"type":"topic","role":"collectionGroup","identifier":"doc:\/\/AriNote\/documentation\/AriNote\/UIKit","url":"\/documentation\/arinote\/uikit"},"doc://AriNote/documentation/AriNote":{"kind":"symbol","type":"topic","identifier":"doc:\/\/AriNote\/documentation\/AriNote","abstract":[{"type":"codeVoice","code":"Today I Learned"}],"url":"\/documentation\/arinote","title":"Ari's Notes","role":"collection"}}}