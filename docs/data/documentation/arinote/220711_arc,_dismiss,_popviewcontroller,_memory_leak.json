{"sections":[],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/arinote\/220711_arc,_dismiss,_popviewcontroller,_memory_leak"]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"primaryContentSections":[{"kind":"content","content":[{"text":"TIL (Today I Learned)","level":1,"type":"heading","anchor":"TIL-Today-I-Learned"},{"type":"paragraph","inlineContent":[{"text":"7월 11일 (월)","type":"text"}]},{"level":2,"anchor":"%ED%95%99%EC%8A%B5-%EB%82%B4%EC%9A%A9","type":"heading","text":"학습 내용"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"ViewController를 ","type":"text"},{"code":"dismiss","type":"codeVoice"},{"type":"text","text":", 혹은 "},{"code":"popViewController","type":"codeVoice"},{"text":" 했을 때, 메모리 할당이 해제 되지 않는 이유가 뭘까?","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":" "}]},{"type":"heading","text":"고민한 점 \/ 해결 방법","level":2,"anchor":"%EA%B3%A0%EB%AF%BC%ED%95%9C-%EC%A0%90--%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95"},{"name":"Note","content":[{"type":"paragraph","inlineContent":[{"text":"개인 프로젝트를 하던 와중에 Coordinator 패턴을 활용하여 화면 제어를 하고 있었다. 그러다가 간혹 dismiss, popViewController를 시도하면 해당 뷰 컨트롤러가 메모리에서 사라져야 하는데, 죽지않고 살아남아있는 경우가 발생하는 걸 발견해버렸다. 이를 해결하려고 방법을 찾아보았다.","type":"text"}]}],"style":"note","type":"aside"},{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/i.imgur.com\/gar9H4P.gif","type":"image"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"첫번째 시도"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"뷰가 사라질 때 ViewController가 가지고 있는 ViewModel을 nil처리를 해주어보았다."}]}]},{"content":[{"inlineContent":[{"text":"하지만 효과는 없었다. 이 문제가 아닌 것 같았다.","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"두번째 시도","type":"codeVoice"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"방법을 모색하던 와중에, 해당 내용에 대한 stackoverflow 질문 글을 찾게 되었다.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"뷰 컨트롤러를 닫거나, 팝할 때 강력한 참조를 만들지 않은 경우에만 할당이 해제된다는 답변이 있었다.","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"}]}]},{"inlineContent":[{"type":"text","text":"따라서 "},{"isActive":true,"type":"reference","identifier":"https:\/\/stackoverflow.com\/a\/21621174\/19072322"},{"text":"을 참고하여, 문제가 발생하는 뷰 컨트롤러에 강한 참조를 하고 있는 부분이 있나 체크를 해보았다.","type":"text"}],"type":"paragraph"},{"type":"aside","style":"note","name":"Note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"위에서 말했던 문제가 발생하던 뷰 컨트롤러의 수가 적지 않았다. 살펴보니 대부분 바인딩 처리해주는 부분에서 옵저버블을 구독하는 시점에 self를 약한 참조로 사용하지 않고 강한 참조로 사용하던 부분 때문에 발생하던 문제였다."}]}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"해결 방법"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"뷰 바인딩 처리해주는 부분에서, 혹은 ViewController 내부에서 self를 사용하는 구간을 모두 약한 참조를 하도록 바꾸어주었다."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"그리고 viewModel을 뷰 컨트롤러가 소유했던 방향을 "},{"code":"bind(to:)","type":"codeVoice"},{"type":"text","text":" 라는 메소드로 변경하여 "},{"code":"파라미터로 뷰모델을 전달받아 바인딩 처리","type":"codeVoice"},{"type":"text","text":"를 하도록 구조를 수정해주었다."}],"type":"paragraph"}]}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"https:\/\/i.imgur.com\/QFFaMwa.gif"}]},{"type":"thematicBreak"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"참고링크"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"https:\/\/stackoverflow.com\/questions\/21398934\/why-arc-is-not-deallocating-memory-after-popviewcontroller","type":"text"}]}]}]}]}]}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/AriNote\/documentation\/AriNote\/220711_ARC,_dismiss,_popViewController,_memory_leak"},"metadata":{"role":"article","roleHeading":"Article","title":"220711 ARC, dismiss, popViewController, memory leak","modules":[{"name":"Ari's Notes"}]},"kind":"article","hierarchy":{"paths":[["doc:\/\/AriNote\/documentation\/AriNote","doc:\/\/AriNote\/documentation\/AriNote\/UIKit"]]},"references":{"https://i.imgur.com/gar9H4P.gif":{"alt":null,"identifier":"https:\/\/i.imgur.com\/gar9H4P.gif","type":"image","variants":[{"url":"https:\/\/i.imgur.com\/gar9H4P.gif","traits":["1x","light"]}]},"https://stackoverflow.com/a/21621174/19072322":{"identifier":"https:\/\/stackoverflow.com\/a\/21621174\/19072322","titleInlineContent":[{"type":"text","text":"이 답변"}],"url":"https:\/\/stackoverflow.com\/a\/21621174\/19072322","title":"이 답변","type":"link"},"doc://AriNote/documentation/AriNote":{"kind":"symbol","type":"topic","identifier":"doc:\/\/AriNote\/documentation\/AriNote","abstract":[{"type":"codeVoice","code":"Today I Learned"}],"url":"\/documentation\/arinote","title":"Ari's Notes","role":"collection"},"https://i.imgur.com/QFFaMwa.gif":{"alt":null,"identifier":"https:\/\/i.imgur.com\/QFFaMwa.gif","type":"image","variants":[{"url":"https:\/\/i.imgur.com\/QFFaMwa.gif","traits":["1x","light"]}]},"doc://AriNote/documentation/AriNote/UIKit":{"kind":"article","title":"UIKit","abstract":[{"type":"text","text":"한몸이 되보자…"}],"type":"topic","role":"collectionGroup","identifier":"doc:\/\/AriNote\/documentation\/AriNote\/UIKit","url":"\/documentation\/arinote\/uikit"}}}