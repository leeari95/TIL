{"hierarchy":{"paths":[["doc:\/\/AriNote\/documentation\/AriNote","doc:\/\/AriNote\/documentation\/AriNote\/Architecture"]]},"kind":"article","identifier":{"url":"doc:\/\/AriNote\/documentation\/AriNote\/220303_Clean_Architecture_MVVM,_async,_await","interfaceLanguage":"swift"},"metadata":{"modules":[{"name":"Ari's Notes"}],"roleHeading":"Article","role":"article","title":"220303 Clean Architecture MVVM, async, await"},"primaryContentSections":[{"kind":"content","content":[{"text":"TIL (Today I Learned)p","type":"heading","anchor":"TIL-Today-I-Learnedp","level":1},{"inlineContent":[{"type":"text","text":"3월 3일 (목)"}],"type":"paragraph"},{"text":"학습 내용","level":2,"anchor":"%ED%95%99%EC%8A%B5-%EB%82%B4%EC%9A%A9","type":"heading"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"오늘은 하루종일 ViewModel 설계 삽질했다ㅎㅎ"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"비비 특강"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"Concurrency await async actor","type":"codeVoice"}]}]}],"type":"unorderedList"}]}]},{"inlineContent":[{"type":"text","text":" "}],"type":"paragraph"},{"anchor":"%EA%B3%A0%EB%AF%BC%ED%95%9C-%EC%A0%90--%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95","level":2,"type":"heading","text":"고민한 점 \/ 해결 방법"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"[Clean architecture MVVM]","type":"text"}]}]},{"type":"paragraph","inlineContent":[{"text":"Rx로 ViewModel 구현해보겠다고 설치다가 결국엔 다 지웠다.","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"일단 Rx없이 ViewModel을 구현하고 이후 리팩토링을 해야겠다…"},{"type":"text","text":" "},{"text":"다 지우고 클린 아키텍처라도 적용해보자고 맘먹고 ViewModel을 짜보았다.","type":"text"},{"type":"text","text":" "},{"text":"(근데 시간이 될까..?)","type":"text"}]},{"anchor":"MVVM%EC%9D%84-%EC%99%9C-%EC%93%B8%EA%B9%8C","level":3,"type":"heading","text":"MVVM을 왜 쓸까?"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"구체적인 View를 알지 못하더라도 요구사항에 따라 ViewModel을 설계할 수 있다.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"ViewModel을 재사용 단위로 설계할 수도 있다."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Testable하다."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"MVVM을 쓰는 가장 큰 이유는 Command 패턴과 Data Binding이 핵심이기 때문","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"View에서 명령을 주면 ViewModel에서 처리하고 데이터를 View에 알아서 바인딩 해주는 시스템"}],"type":"paragraph"}]}]},{"anchor":"Presentation","text":"Presentation","type":"heading","level":3},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"View","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"ViewModel: UI 이벤트가 발생하면 어떤 이벤트인지 판단 후 UseCase를 요청한 후 View에 업데이트를 하라고 알려줌"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":3,"text":"Domain","type":"heading","anchor":"Domain"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"UseCase: 비즈니스 로직","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Repository : 도메인과 데이터의 인터페이스 역할"}],"type":"paragraph"}]}]}]}]},{"anchor":"Data","level":3,"text":"Data","type":"heading"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Storage : 데이터 입출력이 실행되는 곳"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"영구 저장소, 네트워크 등…","type":"text"}],"type":"paragraph"}]}]}]}]},{"anchor":"%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%9D%90%EB%A6%84","level":3,"type":"heading","text":"데이터 흐름"},{"items":[{"content":[{"inlineContent":[{"text":"View는 ViewModel의 메소드를 호출","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"ViewModel에서 어떤 이벤트인지 판단한다.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"이벤트에 따라 UseCase를 실행"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"UseCase는 User와 Repository를 결합"}]}]},{"content":[{"inlineContent":[{"text":"각 Repository는 네트워크, DB관련 스토리지, 메모리 관련 Storage에서 데이터 반환","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"다시 UI에 업데이트"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Storage -> Repository -> UseCase -> ViewModel -> View","type":"text"}],"type":"paragraph"}]}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"image","identifier":"https:\/\/i.imgur.com\/aDHA7m0.png"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/i.imgur.com\/9VG3JyK.png","type":"image"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"나도 한번 따라 만들어봤는데, 뭔가 기능이 중첩되는 느낌…. 아직 메모리 스토리지라 그런건가…. 파이어베이스나 코어데이터 생기면 그럴싸해질까…?","type":"text"}]}],"name":"Note","type":"aside","style":"note"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"https:\/\/i.imgur.com\/5S1tmWk.png"}]},{"type":"thematicBreak"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"[Concurrency await async actor]"}],"type":"strong"}]},{"level":3,"text":"동기 프로그래밍이란?","type":"heading","anchor":"%EB%8F%99%EA%B8%B0-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%B4%EB%9E%80"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"프로그램의 흐름과 이벤트의 발생 및 처리를 종속적으로 수행하는 방법","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"sync programming","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/i.imgur.com\/48YkDHs.png","type":"image"}]}]}]},{"type":"heading","text":"비동기 프로그래밍이란?","anchor":"%EB%B9%84%EB%8F%99%EA%B8%B0-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%B4%EB%9E%80","level":3},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"프로그램의 흐름과 이벤트의 발생 및 처리를 독립적으로 수행하는 방법"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"async Programming"},{"type":"text","text":" "},{"type":"image","identifier":"https:\/\/i.imgur.com\/pIUIBPx.png"}]}]}]},{"type":"codeListing","syntax":null,"code":["* 비동기 프로그래밍","    * 프로그램의 흐름과 이벤트의 발생 및 처리를 독립적으로 수행하는 방법","    ","* 동시성 프로그래밍","    * 여러 작업이 논리적인 관점에서 동시에 수행되는 것","    싱글 코어 또는 멀티 코어에서 멀티 스레딩을 하기 위해 적용","    ","* 병렬성 프로그래밍","    * 여러 작업이 물리적인 관점에서 동시에 수행되는 것"]},{"type":"thematicBreak"},{"anchor":"%EA%B8%B0%EC%A1%B4%EC%9D%98-%EB%8F%99%EC%8B%9C%EC%84%B1-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9D%98-%EB%AC%B8%EC%A0%9C","level":3,"type":"heading","text":"기존의 동시성 프로그래밍의 문제"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"과도한 중첩 (a.k.a. 장풍 코드)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"오류 처리의 어려움"}]}]}],"type":"unorderedList"},{"inlineContent":[{"identifier":"https:\/\/i.imgur.com\/plURgxQ.png","type":"image"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"https:\/\/i.imgur.com\/eAvZzw0.png"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"조건부 실행의 어려움","type":"text"}]}]}]},{"inlineContent":[{"identifier":"https:\/\/i.imgur.com\/dk0bU16.png","type":"image"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"swizzle"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"런타임 시점에 조건에 따라서 다른 메소드로 바꿔서 실행한다."}]}]}]}]}]},{"type":"paragraph","inlineContent":[{"text":"함수의 실행 흐름이 자연스럽지 못하다.","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"실수하기 쉽다."}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/i.imgur.com\/pWIZUTz.jpg","type":"image"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"하지만 async await을 사용하면 동기코드처럼 작성할 수 있다."}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"https:\/\/i.imgur.com\/wv4cHt2.png"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"간단히 살펴보는 문법"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/i.imgur.com\/zTK5oQB.png","type":"image"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"get만 가능!"}]}]}]},{"inlineContent":[{"identifier":"https:\/\/i.imgur.com\/PSYJDZ7.png","type":"image"}],"type":"paragraph"},{"type":"thematicBreak"},{"text":"동작 흐름","level":3,"type":"heading","anchor":"%EB%8F%99%EC%9E%91-%ED%9D%90%EB%A6%84"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"async는 함수를 suspend 시킬 수 있다."}]}]},{"content":[{"inlineContent":[{"text":"await 키워드를 만나면 스레드 block을 해제하고 suspend 된다.","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"즉 await 키워드가 suspend를 시키는 지점"}]}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"suspend 된 함수가 있을 때, 다른 작업은 진행될 수 있다.","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"즉 비동기적으로 작업을 할 수 있다."}]}]}]}]}]},{"name":"Note","content":[{"inlineContent":[{"type":"text","text":"스레드 block을 해제하고 suspend 된다. -> 함수가 스레드에 대한 제어권을 포기한다."}],"type":"paragraph"}],"style":"note","type":"aside"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"이 개념은 코루틴(Coroutine)에서 출발했는데…"},{"text":" ","type":"text"},{"text":"Swift의 async\/await은 코루틴 모델을 적용했다.","type":"text"}],"type":"paragraph"}]}]},{"text":"코루틴(Coroutine)이란?","level":3,"type":"heading","anchor":"%EC%BD%94%EB%A3%A8%ED%8B%B4Coroutine%EC%9D%B4%EB%9E%80"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"루틴(소프트웨어에서 특정 동작을 수행하는 일정 코드 부분)의 일종","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"두 개 이상의 루틴이 서로를 호출하는 관계","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"서브 루틴을 구분할 수 없다."}],"type":"paragraph"}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"A를 프로그래밍할 때는 B를 A의 서브루틴으로 생각 (반대도 성립)","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"실행되는 코루틴은 이전에 자신의 실행이 마지막으로 중단되었던 지점 다음의 장소에서 실행을 재개"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"이게 가장 중요한 부분."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"중간에 suspend되었다가 다시 실행될 수 있다."}],"type":"paragraph"}]}]}]}]},{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/i.imgur.com\/K61HYy5.png","type":"image"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"동기함수는 스레드의 제어권이 계속 남아있다.","type":"text"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/i.imgur.com\/QpHUXCp.png","type":"image"}]},{"items":[{"content":[{"inlineContent":[{"text":"await키워드를 만나면 스레드에 대한 제어권을 포기한다고 했다.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"즉 스레드에 대한 제어권을 System에게 맡긴다.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"그리고 작업이 완료되었다면 resume을 통해서 다시 돌아와서, 처음 suspend된 시점부터 시작되어 돌아간다.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"async 함수가 호출된 쓰레드가 메인이라면 await 이후에도 메인쓰레드에서 실행된다."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"async 프로퍼티도 가능!"}]}]}],"type":"unorderedList"},{"type":"thematicBreak"},{"type":"paragraph","inlineContent":[{"text":"[느낀 점]","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"비동기 코드가 동기 코드처럼 반환값을 가질 수 있게되었다.","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"이전엔 DispatchQueue로 global 스레드에 작업을 보내서 처리해준 부분이 await 키워드만 있으면, await 시점부터는 system이 알아서 스레드 관리를 해주는 느낌이다."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"하지만.. 나온지 얼마안되서 아직은 개인 프로젝트에서만 활용할 수 있을 것 같다."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"그리고 wwdc 영상을 꼭 보아라…"}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"image","identifier":"https:\/\/i.imgur.com\/Lvu06kh.png"}],"type":"paragraph"},{"type":"thematicBreak"},{"items":[{"content":[{"inlineContent":[{"text":"참고링크","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"https:\/\/ios-development.tistory.com\/555?category=978961"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"https:\/\/tech.olx.com\/clean-architecture-and-mvvm-on-ios-c9d167d9f5b3"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"https:\/\/github.com\/iamchiwon\/whatisarchitecture"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"https:\/\/github.com\/kudoleh\/iOS-Clean-Architecture-MVVM"}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"type":"unorderedList"}]}],"schemaVersion":{"patch":0,"major":0,"minor":3},"sections":[],"variants":[{"paths":["\/documentation\/arinote\/220303_clean_architecture_mvvm,_async,_await"],"traits":[{"interfaceLanguage":"swift"}]}],"references":{"https://i.imgur.com/Lvu06kh.png":{"variants":[{"traits":["1x","light"],"url":"https:\/\/i.imgur.com\/Lvu06kh.png"}],"identifier":"https:\/\/i.imgur.com\/Lvu06kh.png","type":"image","alt":null},"https://i.imgur.com/pWIZUTz.jpg":{"variants":[{"url":"https:\/\/i.imgur.com\/pWIZUTz.jpg","traits":["1x","light"]}],"identifier":"https:\/\/i.imgur.com\/pWIZUTz.jpg","type":"image","alt":null},"doc://AriNote/documentation/AriNote":{"kind":"symbol","type":"topic","identifier":"doc:\/\/AriNote\/documentation\/AriNote","abstract":[{"type":"codeVoice","code":"Today I Learned"}],"url":"\/documentation\/arinote","title":"Ari's Notes","role":"collection"},"https://i.imgur.com/pIUIBPx.png":{"variants":[{"traits":["1x","light"],"url":"https:\/\/i.imgur.com\/pIUIBPx.png"}],"identifier":"https:\/\/i.imgur.com\/pIUIBPx.png","type":"image","alt":null},"https://i.imgur.com/48YkDHs.png":{"variants":[{"url":"https:\/\/i.imgur.com\/48YkDHs.png","traits":["1x","light"]}],"identifier":"https:\/\/i.imgur.com\/48YkDHs.png","type":"image","alt":null},"https://i.imgur.com/K61HYy5.png":{"variants":[{"traits":["1x","light"],"url":"https:\/\/i.imgur.com\/K61HYy5.png"}],"identifier":"https:\/\/i.imgur.com\/K61HYy5.png","type":"image","alt":null},"https://i.imgur.com/aDHA7m0.png":{"variants":[{"url":"https:\/\/i.imgur.com\/aDHA7m0.png","traits":["1x","light"]}],"identifier":"https:\/\/i.imgur.com\/aDHA7m0.png","type":"image","alt":null},"https://i.imgur.com/9VG3JyK.png":{"variants":[{"traits":["1x","light"],"url":"https:\/\/i.imgur.com\/9VG3JyK.png"}],"identifier":"https:\/\/i.imgur.com\/9VG3JyK.png","type":"image","alt":null},"https://i.imgur.com/zTK5oQB.png":{"variants":[{"url":"https:\/\/i.imgur.com\/zTK5oQB.png","traits":["1x","light"]}],"identifier":"https:\/\/i.imgur.com\/zTK5oQB.png","type":"image","alt":null},"https://i.imgur.com/eAvZzw0.png":{"variants":[{"traits":["1x","light"],"url":"https:\/\/i.imgur.com\/eAvZzw0.png"}],"identifier":"https:\/\/i.imgur.com\/eAvZzw0.png","type":"image","alt":null},"https://i.imgur.com/dk0bU16.png":{"variants":[{"url":"https:\/\/i.imgur.com\/dk0bU16.png","traits":["1x","light"]}],"identifier":"https:\/\/i.imgur.com\/dk0bU16.png","type":"image","alt":null},"doc://AriNote/documentation/AriNote/Architecture":{"role":"collectionGroup","kind":"article","identifier":"doc:\/\/AriNote\/documentation\/AriNote\/Architecture","abstract":[{"text":"공부 많이해서 상황에 따라 적절한 아키텍처를 선택해보자.","type":"text"}],"title":"Architecture","type":"topic","url":"\/documentation\/arinote\/architecture"},"https://i.imgur.com/plURgxQ.png":{"variants":[{"traits":["1x","light"],"url":"https:\/\/i.imgur.com\/plURgxQ.png"}],"identifier":"https:\/\/i.imgur.com\/plURgxQ.png","type":"image","alt":null},"https://i.imgur.com/wv4cHt2.png":{"variants":[{"url":"https:\/\/i.imgur.com\/wv4cHt2.png","traits":["1x","light"]}],"identifier":"https:\/\/i.imgur.com\/wv4cHt2.png","type":"image","alt":null},"https://i.imgur.com/PSYJDZ7.png":{"variants":[{"traits":["1x","light"],"url":"https:\/\/i.imgur.com\/PSYJDZ7.png"}],"identifier":"https:\/\/i.imgur.com\/PSYJDZ7.png","type":"image","alt":null},"https://i.imgur.com/QpHUXCp.png":{"variants":[{"url":"https:\/\/i.imgur.com\/QpHUXCp.png","traits":["1x","light"]}],"identifier":"https:\/\/i.imgur.com\/QpHUXCp.png","type":"image","alt":null},"https://i.imgur.com/5S1tmWk.png":{"variants":[{"traits":["1x","light"],"url":"https:\/\/i.imgur.com\/5S1tmWk.png"}],"identifier":"https:\/\/i.imgur.com\/5S1tmWk.png","type":"image","alt":null}}}