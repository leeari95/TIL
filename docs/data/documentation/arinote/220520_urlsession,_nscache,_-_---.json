{"metadata":{"roleHeading":"Article","role":"article","modules":[{"name":"Ari's Notes"}],"title":"220520 URLSession, NSCache, 셀 재사용"},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/AriNote\/documentation\/AriNote\/220520_URLSession,_NSCache,_-_---"},"kind":"article","hierarchy":{"paths":[["doc:\/\/AriNote\/documentation\/AriNote","doc:\/\/AriNote\/documentation\/AriNote\/UIKit"]]},"sections":[],"primaryContentSections":[{"kind":"content","content":[{"text":"TIL (Today I Learned)","type":"heading","anchor":"TIL-Today-I-Learned","level":1},{"inlineContent":[{"type":"text","text":"5월 20일 (금)"}],"type":"paragraph"},{"text":"학습 내용","level":2,"anchor":"%ED%95%99%EC%8A%B5-%EB%82%B4%EC%9A%A9","type":"heading"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"이미지 캐싱 중 깜빡거리는 현상 문제 해결"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"text":" ","type":"text"}]},{"text":"고민한 점 \/ 해결 방법","anchor":"%EA%B3%A0%EB%AF%BC%ED%95%9C-%EC%A0%90--%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95","level":2,"type":"heading"},{"type":"aside","name":"Note","style":"note","content":[{"inlineContent":[{"type":"text","text":"서포터즈 활동 중, 두두와 사파리의 질문으로 나도 처음으로 겪은 문제를 기록하려고 한다."}],"type":"paragraph"}]},{"type":"heading","level":3,"text":"상황","anchor":"%EC%83%81%ED%99%A9"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"https:\/\/i.imgur.com\/xH0xH3k.gif"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"cell을 엄!!!청!!! 빠르게 스크롤해서 내릴때"},{"text":" ","type":"text"},{"type":"text","text":"사라진 셀에서 시작된 이미지 다운로드가 멈추지 않아서"},{"type":"text","text":" "},{"type":"text","text":"이미지가 깜빡 거리는 현상이 나타나는 듯 보였음."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"즉 빠르게 스크롤 하게 되면,","type":"text"},{"type":"text","text":" "},{"text":"이미지 다운로드가 모두 멈추지않고 진행되면서","type":"text"},{"type":"text","text":" "},{"text":"이미지가 깜빡거리는 현상이 있었음.","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"이미지가 계속 다운로드 되면서 이미지뷰의 이미지를 계속 할당하는 현상."}]}]}]}]}],"type":"unorderedList"},{"type":"heading","level":1,"anchor":"","text":""},{"type":"heading","anchor":"%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95","text":"해결 방법","level":3},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"이미지 다운 받는 작업(Task)을 프로퍼티로 따로 선언해준다."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"prepareForReuse()에서 Task를 중지, 취소를 하는 작업을 추가해준다. (suspend, cancel)"}]}]}]},{"syntax":"swift","type":"codeListing","code":["private var imageDownloadTask: URLSessionDataTask?","","private func downloadImage(imageURL: String?) {","   imageDownloadTask = ImageManager.shared.downloadImage(urlString: imageURL) { [weak self] result in","        switch result {","        case .success(let image):","            DispatchQueue.main.async {","                self?.thumbnailImageView.image = image","            }","        case .failure(_):","            break","        }","    }","}"]},{"syntax":"swift","code":["override func prepareForReuse() {","    super.prepareForReuse()","    \/\/ 문서에 중단된 작업들만 취소할 수 있다고 나와있음!","    imageDownloadTask?.suspend()","    imageDownloadTask?.cancel()","}"],"type":"codeListing"},{"type":"aside","style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"이렇게해서 이미지가 다운로드 중이여도 prepareForReuse가 호출된다면 작업이 중지, 취소되기 때문에 이미지가 깜빡거리는 현상을 해결할 수 있게 되었다."}]}],"name":"Note"},{"anchor":"","text":"","type":"heading","level":1},{"type":"heading","text":"소감","anchor":"%EC%86%8C%EA%B0%90","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"그냥 의견 제시만 했을 뿐인데… 뚝딱 스무스하게 해결해버리셨다;;; 멋져부러…"},{"type":"text","text":" "},{"text":"나도 처음 겪는 문제라 메모해놔야징…ㅎ","type":"text"}]},{"type":"thematicBreak"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"참고링크"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"https:\/\/developer.apple.com\/documentation\/uikit\/uitableviewcell\/1623223-prepareforreuse","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"https:\/\/developer.apple.com\/documentation\/foundation\/urlsessiontask\/1411565-suspend"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"https:\/\/developer.apple.com\/documentation\/foundation\/urlsessiontask\/1411591-cancel","type":"text"}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"}]}],"variants":[{"paths":["\/documentation\/arinote\/220520_urlsession,_nscache,_-_---"],"traits":[{"interfaceLanguage":"swift"}]}],"schemaVersion":{"minor":3,"major":0,"patch":0},"references":{"doc://AriNote/documentation/AriNote":{"kind":"symbol","type":"topic","identifier":"doc:\/\/AriNote\/documentation\/AriNote","abstract":[{"type":"codeVoice","code":"Today I Learned"}],"url":"\/documentation\/arinote","title":"Ari's Notes","role":"collection"},"https://i.imgur.com/xH0xH3k.gif":{"identifier":"https:\/\/i.imgur.com\/xH0xH3k.gif","variants":[{"url":"https:\/\/i.imgur.com\/xH0xH3k.gif","traits":["1x","light"]}],"alt":"https:\/\/i.imgur.com\/xH0xH3k.gif","type":"image"},"doc://AriNote/documentation/AriNote/UIKit":{"kind":"article","title":"UIKit","abstract":[{"type":"text","text":"한몸이 되보자…"}],"type":"topic","role":"collectionGroup","identifier":"doc:\/\/AriNote\/documentation\/AriNote\/UIKit","url":"\/documentation\/arinote\/uikit"}}}